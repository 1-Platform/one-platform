<section class="lighthouse-block">
    <div class="pf-l-bullseye">
        <div class="pf-u-font-size-2xl pf-u-text-align-center pf-u-mt-xl pf-u-mb-4xl">
            Measure performance of your application
        </div>
    </div>

    <div class="pf-l-bullseye">
        <div class="pf-l-bullseye__item pf-u-ml-4xl pf-u-mr-4xl">
            <div class="lighthouse-step-dot pf-u-ml-4xl pf-u-mr-4xl">
                <span>1</span>
            </div>
            <div class="pf-u-text-align-center">
                <div class="pf-u-font-size-lg">Run Tests on your site</div>
            </div>
            <span class="pf-u-text-align-center pf-u-color-400">Enter your site's url to see how<br />well it performs
                across all audits.</span>
        </div>

        <div class="pf-l-bullseye__item pf-u-ml-4xl pf-u-mr-4xl">
            <div class="lighthouse-step-dot pf-u-ml-4xl pf-u-mr-4xl">
                <span>2</span>
            </div>
            <div class="pf-u-text-align-center">
                <div class="pf-u-font-size-lg">Look at what matters</div>
            </div>
            <span class="pf-u-text-align-center pf-u-color-400">See your site's performance across<br />the areas you
                care about.</span>
        </div>

        <div class="pf-l-bullseye__item pf-u-ml-4xl pf-u-mr-4xl">
            <div class="lighthouse-step-dot pf-u-ml-4xl pf-u-mr-4xl">
                <span>3</span>
            </div>
            <div class="pf-u-text-align-center">
                <div class="pf-u-font-size-lg">Get tips for improving</div>
            </div>
            <span class="pf-u-text-align-center pf-u-color-400">Each test comes with helpful steps<br />to improve your
                site's results.</span>
        </div>
    </div>
    <div class="pf-l-bullseye pf-u-mt-2xl">
        <div class="pf-c-input-group pf-u-w-33">
            <input class="pf-c-form-control" type="text" id="sites" name="sites" aria-label="Enter webpage url"
                placeholder="Enter web page url" [(ngModel)]="sites" />
            <button class="pf-c-button pf-m-control" type="button" aria-label="Popover for input" disabled>
                <i class="fas fa-window-restore" aria-hidden="true"></i>
            </button>
        </div>

        &nbsp;
        <button class="pf-c-button pf-m-progress pf-m-primary" type="button" *ngIf="!loading"
            (click)="auditWebsite()">Run Audit</button>

        <button class="pf-c-button pf-m-progress pf-m-in-progress pf-m-primary" type="button" *ngIf="loading">
            <span class="pf-c-button__progress">
                <span class="pf-c-spinner pf-m-md" role="progressbar" aria-valuetext="Loading...">
                    <span class="pf-c-spinner__clipper"></span>
                    <span class="pf-c-spinner__lead-ball"></span>
                    <span class="pf-c-spinner__tail-ball"></span>
                </span>
            </span>
            Running Audit
        </button>
    </div>

    <div class="pf-l-bullseye pf-u-mt-2xl">
        <div class="pf-u-font-weight-bold">Presets</div>: &nbsp;
        <span *ngFor="let preset of presets;index as i">
            <input type="radio" name="preset" value="{{ preset.value }}" [(ngModel)]="selectedPreset">&nbsp;
            <label for="preset">{{ preset.name }}</label>&nbsp;&nbsp;
        </span>
    </div>
    <div class="pf-l-bullseye pf-u-mt-md" *ngIf="showScore">
        <div class="gauge-chart" *ngFor="let report of lhciScores">
            <svg viewBox="0 0 36 36" class="gauge-circle-chart {{report.class}}">
                <path class="gauge-circle-bg" d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831" />
                <path class="gauge-circle" attr.stroke-dasharray="{{report.score}}, 100" d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831" />
                <text x="18" y="20.35" class="gauge-percentage">{{report.score}}%</text>
            </svg>
            <p class="pf-u-text-align-center">{{report.name}}</p>
        </div>
    </div>

    <div class="pf-c-code-block">
        <div class="pf-c-code-block__header pf-u-mt-2xl">
            <div class="pf-c-code-block__actions">
                <div class="pf-c-code-block__actions-item">
                    <button class="pf-c-button pf-m-plain" type="button" aria-label="Upload to lighthouse ci server"
                        (click)="toggleModal=true">
                        <i class="fas fa-upload" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
        </div>
        <div class="pf-c-code-block__content lighthouse-code-block" id="codeBlock">
            <pre class="pf-c-code-block__pre"><code class="pf-c-code-block__code" [innerHtml]="auditProgress"></code>
            </pre>
        </div>
    </div>

    <!-- Upload Modal -->
    <div class="pf-c-backdrop" *ngIf="toggleModal">
        <div class="pf-l-bullseye">
            <div class="pf-c-modal-box pf-u-w-50" role="dialog" aria-modal="true" aria-labelledby="upload-results-title"
                aria-describedby="upload-results-description">
                <button class="pf-c-button pf-m-plain" type="button" aria-label="Close" (click)="toggleModal = false">
                    <i class="fas fa-times" aria-hidden="true"></i>
                </button>
                <header class="pf-c-modal-box__header">
                    <h1 class="pf-c-modal-box__title" id="upload-results-title">Upload results to Lighthouse CI Server
                    </h1>
                </header>
                <div class="pf-c-modal-box__body">
                    <div class="pf-l-grid pf-m-gutter">
                        <div class="pf-l-grid__item pf-m-4-col">
                            <label for="project-select">Project</label>
                            <select class="pf-c-form-control pf-m-placeholder" id="project-select" name="project-select"
                                aria-label="project select" [(ngModel)]="projectID" required>
                                <option value disabled selected>Select Project</option>
                                <option *ngFor="let project of projects" [value]="project.id">{{ project.name }}
                                </option>
                            </select>
                        </div>

                        <div class="pf-l-grid__item pf-m-4-col">
                            <label for="project-branch">Branch</label>
                            <select class="pf-c-form-control pf-m-placeholder" id="project-branch" name="project-branch"
                                aria-label="project branch" [(ngModel)]="property.currentBranch"
                                (click)="validUploadConfig=false;fetchProjectBranches();fetchProjectDetails();"
                                required>
                                <option value disabled selected>Select Branch</option>
                                <option *ngFor="let project of projectBranches" [value]="project.branch">{{
                                    project.branch }}</option>
                            </select>
                        </div>

                        <div class="pf-l-grid__item pf-m-4-col">
                            <label for="build-token">Build Token</label>
                            <input class="pf-c-form-control" type="text" [(ngModel)]="property.buildToken"
                                id="buildToken" aria-label="Build Token" placeholder="Enter Build Token"
                                name="buildToken" (blur)="fetchProjectDetails()" required/>
                        </div>
                    </div>

                </div>
                <footer class="pf-c-modal-box__footer">
                    <button class="pf-c-button pf-m-primary" (click)="upload(property)"
                        [disabled]="!validUploadConfig">Upload</button>
                </footer>
            </div>
        </div>
    </div>

</section>